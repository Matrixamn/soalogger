/*
Created: 14.1.2011
Modified: 3.2.2011
Model: PostgreSQL 8.4
Database: PostgreSQL 8.4
*/

-- Create schemas section -------------------------------------------------

CREATE SCHEMA "soalog"
;

-- Create tables section -------------------------------------------------

-- Table soalog.LOG_INTERFACE

CREATE TABLE "soalog"."LOG_INTERFACE"(
 "LOG_INTERFACE_ID" Bigint NOT NULL,
 "LOG_INTERFACE_NAME" Text,
 "LOG_INTERFACE_VERSION" Text,
 "LOG_MESSAGE_FLAG" Text,
 "PREFERRED_LOGGING_LEVEL" Text,
 "MSG_MAX_LENGHT" Bigint,
 "ENVIRONMENT_FLAG" Text,
 "INTEGRATION_TYPE" Text,
 "MSG_ENCODING" Text,
 "APPLY_BASE64" Text
)
WITH (OIDS=FALSE)
;

-- Add keys for table soalog.LOG_INTERFACE

ALTER TABLE "soalog"."LOG_INTERFACE" ADD CONSTRAINT "Key1" PRIMARY KEY ("LOG_INTERFACE_ID")
;

ALTER TABLE "soalog"."LOG_INTERFACE" ADD CONSTRAINT "LOG_INTERFACE_ID" UNIQUE ("LOG_INTERFACE_ID")
;

-- Table soalog.LOG_ENTRY

CREATE TABLE "soalog"."LOG_ENTRY"(
 "LOG_ENTRY_ID" Bigint NOT NULL,
 "INTEGRATION_INSTANCE_ID" Text NOT NULL,
 "INSTANCE_VERSION" Text,
 "LOG_DATE" Timestamp NOT NULL,
 "LOG_LEVEL" Text NOT NULL,
 "LOG_MSG" Text NOT NULL,
 "LOG_PAYLOAD" Text,
 "LOG_INTERFACE_ID" Bigint
)
WITH (OIDS=FALSE)
;

-- Add keys for table soalog.LOG_ENTRY

ALTER TABLE "soalog"."LOG_ENTRY" ADD CONSTRAINT "Key2" PRIMARY KEY ("LOG_ENTRY_ID")
;

ALTER TABLE "soalog"."LOG_ENTRY" ADD CONSTRAINT "LOG_ENTRY_ID" UNIQUE ("LOG_ENTRY_ID")
;

-- Table soalog.LOG_SCHED

CREATE TABLE "soalog"."LOG_SCHED" (
	"LOG_SCHED_ID" Bigint NOT NULL,
	"LOG_INTERFACE_ID" Bigint NOT NULL,
	"DAYS_OLDER_TO_REMOVE" Bigint NOT NULL,
	"LOG_DATE" Timestamp NOT NULL
)
WITH (OIDS=FALSE)
;

ALTER TABLE "soalog"."LOG_SCHED" ADD CONSTRAINT "LOG_SCHED_ID" UNIQUE ("LOG_SCHED_ID")
;

-- Table soalog.LOG_FIELDS

CREATE TABLE "soalog"."LOG_FIELDS"(
 "LOG_FIELD_ID" Bigint NOT NULL,
 "LOG_FIELD_NAME" Text NOT NULL,
 "ELEMENT_NAME" Text ,
 "XML_XPATH" Text,
 "LOG_INTERFACE_ID" Bigint
)
WITH (OIDS=FALSE)
;

-- Add keys for table soalog.LOG_FIELDS

ALTER TABLE "soalog"."LOG_FIELDS" ADD CONSTRAINT "Key3" PRIMARY KEY ("LOG_FIELD_ID")
;

ALTER TABLE "soalog"."LOG_FIELDS" ADD CONSTRAINT "LOG_FIELD_ID" UNIQUE ("LOG_FIELD_ID")
;


-- Table soalog.ENTRY_VALUES

CREATE TABLE "soalog"."ENTRY_VALUES"(
 "VALUE_ID" Bigint NOT NULL,
 "VALUE_NAME" Text,
 "ENTRY_VALUE" Text,
 "LOG_ENTRY_ID" Bigint
)
WITH (OIDS=FALSE)
;

-- Add keys for table soalog.ENTRY_VALUES

ALTER TABLE "soalog"."ENTRY_VALUES" ADD CONSTRAINT "Key4" PRIMARY KEY ("VALUE_ID")
;

ALTER TABLE "soalog"."ENTRY_VALUES" ADD CONSTRAINT "VALUE_ID" UNIQUE ("VALUE_ID")
;

-- Table LOGINTERFACE_NOTIFICATION

CREATE TABLE "soalog"."LOGINTERFACE_NOTIFICATION"(
 "LOG_INTERFACE_NOTIFICATION_ID" Bigint NOT NULL,
 "RECIPIENT_EMAIL" Text,
 "NOTIFICATION_DESC" Text,
 "INTERFACE_ENV" Text,
 "LOG_INTERFACE_ID" Bigint NOT NULL
)
WITH (OIDS=FALSE)
;

ALTER TABLE "soalog"."LOGINTERFACE_NOTIFICATION" ADD CONSTRAINT "Key55" PRIMARY KEY ("LOG_INTERFACE_NOTIFICATION_ID")
;

-- Table USER_GROUP

CREATE TABLE "USER_GROUP"(
 "USER_GROUP_ID" Bigint NOT NULL,
 "USER_GROUP_NAME" Text,
 "MAPPED_NAME" Text
)
WITH (OIDS=FALSE)
;

-- Add keys for table USER_GROUP

ALTER TABLE "USER_GROUP" ADD CONSTRAINT "Key5" PRIMARY KEY ("USER_GROUP_ID")
;

-- Table INTERFACE_USER_GROUPS

CREATE TABLE "INTERFACE_USER_GROUPS"(
 "USER_GROUP_ID" Bigint,
 "LOG_INTERFACE_ID" Bigint
)
WITH (OIDS=FALSE)
;

-- Create relationships section ------------------------------------------------- 

ALTER TABLE "soalog"."LOG_ENTRY" ADD CONSTRAINT "Relationship2" FOREIGN KEY ("LOG_INTERFACE_ID") REFERENCES "soalog"."LOG_INTERFACE" ("LOG_INTERFACE_ID") ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE "soalog"."LOG_FIELDS" ADD CONSTRAINT "Relationship3" FOREIGN KEY ("LOG_INTERFACE_ID") REFERENCES "soalog"."LOG_INTERFACE" ("LOG_INTERFACE_ID") ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE "soalog"."ENTRY_VALUES" ADD CONSTRAINT "Relationship4" FOREIGN KEY ("LOG_ENTRY_ID") REFERENCES "soalog"."LOG_ENTRY" ("LOG_ENTRY_ID") ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE "INTERFACE_USER_GROUPS" ADD CONSTRAINT "Relationship5" FOREIGN KEY ("USER_GROUP_ID") REFERENCES "USER_GROUP" ("USER_GROUP_ID") ON DELETE NO ACTION ON UPDATE NO ACTION
;

ALTER TABLE "INTERFACE_USER_GROUPS" ADD CONSTRAINT "Relationship6" FOREIGN KEY ("LOG_INTERFACE_ID") REFERENCES "soalog"."LOG_INTERFACE" ("LOG_INTERFACE_ID") ON DELETE NO ACTION ON UPDATE NO ACTION
;





